{"remainingRequest":"/Users/muhammed/Documents/vue_projects/leadfinder-crm/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/muhammed/Documents/vue_projects/leadfinder-crm/src/views/app/pages/campaign.vue?vue&type=style&index=0&id=327017c3&scoped=true&lang=css&","dependencies":[{"path":"/Users/muhammed/Documents/vue_projects/leadfinder-crm/src/views/app/pages/campaign.vue","mtime":1682325868000},{"path":"/Users/muhammed/Documents/vue_projects/leadfinder-crm/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/muhammed/Documents/vue_projects/leadfinder-crm/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/muhammed/Documents/vue_projects/leadfinder-crm/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/muhammed/Documents/vue_projects/leadfinder-crm/node_modules/vuetify-loader/lib/loader.js","mtime":1574476662000},{"path":"/Users/muhammed/Documents/vue_projects/leadfinder-crm/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/muhammed/Documents/vue_projects/leadfinder-crm/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQoNCkBpbXBvcnQgJy4vc3R5bGUvc3R5bGUuY3NzJzsNCiAgDQoNCiAgLmZvb3Rlci1uZXh0ew0KICBoZWlnaHQ6NzBweDsNCiAgZGlzcGxheTpmbGV4Ow0KDQoNCiAgfQ0K"},{"version":3,"sources":["campaign.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8YA;;;AAGA;AACA;AACA;;;AAGA","file":"campaign.vue","sourceRoot":"src/views/app/pages","sourcesContent":["\r\n<template>\r\n  <div class=\"main-content\">\r\n    <MainHeader></MainHeader>\r\n    <form ref=\"dataForm\" @submit.prevent=\"dataForm()\">\r\n      <div class=\"email-sections\" v-show=\"crnt_tab=='edit'\">\r\n        <main class=\"lead-main\" >\r\n          <div class=\"card p-0\"> \r\n            <div class=\"card-header flex-align\">\r\n              <h4>Email Subject</h4>\r\n              <button class=\"btn btn-primary\" v-b-modal.add-subject>{{campaign.subject?'Edit':'Add'}}</button>\r\n            </div>\r\n            <div class=\"\">\r\n              <textarea v-show=\"false\" name=\"subject\" class=\"mt-2\" v-model=\"campaign.subject\" placeholder=\"Add Subject\"></textarea>\r\n              <p class=\"mb-0 p-3\" v-html=\"campaign.subject\"></p>\r\n            </div>\r\n            <b-modal id=\"add-subject\" hide-header hide-footer>\r\n              <div class=\"modal-bar\"></div>\r\n              <div class=\"modal-header px-0 pb-0 pt-3 border-0\">\r\n                <h4>Add Subject</h4>\r\n              </div>\r\n              <hr class=\"my-2\">\r\n              <div class=\"edit-modal-body2 text-center pb-2\" style=\"row-gap:25px;\">\r\n                <div class=\" edit-textarea\">\r\n                  <textarea spellcheck=\"false\" required=\"required\" name=\"subject\" class=\"mt-2\" v-model=\"campaign.subject\" placeholder=\"Add Subject\"></textarea>\r\n                </div>\r\n              </div>\r\n              <div class=\"footer-modal\">\r\n                <button class=\"btn btn-outline-primary px-3 py-2\" @click=\"$bvModal.hide('add-subject')\">Close</button>\r\n                <button class=\"btn btn-primary px-3 py-2\" @click=\"$bvModal.hide('add-subject')\">+ Add</button>\r\n              </div>\r\n            </b-modal>\r\n          </div>\r\n\r\n          <!-- <div class=\"card p-0\"> \r\n            <div class=\"card-header flex-align\">\r\n              <h4>CRM Contents</h4>\r\n              <button class=\"btn btn-primary py-1\">Edit</button>\r\n            </div>\r\n            <div class=\"card-body\">\r\n              <div class=\"mb-3\">\r\n                <h4 class=\"text-primary text-14\">{{campaign.leads.length}} Email Contents</h4>\r\n              </div>\r\n              <div class=\"row\">\r\n              </div>\r\n              <hr class=\"my-3\">\r\n              <div class=\"\">\r\n                <label v-for=\"lead_category in lead_categories\" :for=\"'lead_category'+lead_category.id\">\r\n                  <h4 class=\"badge p-2 text-14\" :class=\"campaign.lead_categories.includes(lead_category.id)?'badge-info':'badge-outline-info'\">{{lead_category.name}}</h4>\r\n                  <input type=\"checkbox\" :value=\"lead_category.id\" v-model=\"campaign.lead_categories\" name=\"lead_categories\" :id=\"'lead_category'+lead_category.id\" @change=\"showLeads()\" v-show=\"false\">\r\n                </label>\r\n                \r\n                <select name=\"leads\" v-model=\"campaign.leads\" multiple v-show=\"false\">\r\n                  <option v-for=\"lead in leads\" :value=\"lead\">{{ lead }}</option>\r\n                </select>\r\n              </div>\r\n            </div>\r\n          </div> -->\r\n\r\n          <div class=\"card p-0\"> \r\n            <div class=\"card-header flex-align\">\r\n              <h4>Email Audience</h4>\r\n              <!--<button class=\"btn btn-primary py-1\">Edit</button>-->\r\n            </div>\r\n            <div class=\"card-body\">\r\n              <div class=\"mb-2\">\r\n                <h4 class=\"text-primary text-14\">{{campaign.leads.length}} Email Contents</h4>\r\n              </div>\r\n              <div class=\"row\">\r\n                <div class=\"col-6 pr-1 mt-3\">\r\n                  <div class=\" flex-align\">\r\n                    <h4>Start Date</h4>\r\n                  </div>\r\n                  <div class=\" edit-textarea\">\r\n                    <input type=\"date\" name=\"start_date\" class=\"textarea mt-2\" v-model=\"campaign.start_date\" @change=\"showLeads()\">\r\n                  </div>\r\n                </div>\r\n                <div class=\"col-6 pl-1 mt-3\">\r\n                  <div class=\" flex-align\">\r\n                    <h4>End Date</h4>\r\n                  </div>\r\n                  <div class=\" edit-textarea\">\r\n                    <input type=\"date\" name=\"end_date\" class=\"textarea mt-2\" v-model=\"campaign.end_date\" @change=\"showLeads()\">\r\n                  </div>\r\n                </div>\r\n                <div class=\"col-6 pr-1 mt-3\">\r\n                  <div class=\" flex-align\">\r\n                    <h4 class=\"mb-2\">Category</h4>\r\n                  </div>\r\n                  <div class=\" edit-textarea\">\r\n                    <select v-model=\"campaign.lead_category\" name=\"lead_category\"  @change=\"showLeads()\">\r\n                      <option :value=\"null\">Select Category</option>\r\n                      <option v-for=\"lead_category in lead_categories\" :value=\"lead_category.id\">{{lead_category.name}}</option>\r\n                    </select>\r\n                  </div>\r\n                </div>\r\n                <div class=\"col-6 pl-1 mt-3\">\r\n                  <div class=\" flex-align\">\r\n                    <h4 class=\"mb-2\">Status</h4>\r\n                  </div>\r\n                  <div class=\" edit-textarea\">\r\n                    <select name=\"lead_status\" v-model=\"campaign.lead_status\" @change=\"showLeads()\">\r\n                      <option :value=\"''\">All</option>\r\n                      <option v-for=\"lead_status in lead_statuses\" :value=\"lead_status.name\">{{lead_status.name}}</option>\r\n                    </select>\r\n                  </div>\r\n                </div>\r\n                <div class=\"col-12 mt-3\">\r\n                  <div class=\" flex-align\">\r\n                    <h4 class=\"mb-2\">Tags</h4>\r\n                  </div>\r\n                  <div class=\"col-12 px-0 d-flex g2 mt-1\" style=\"flex-flow: wrap;\">\r\n                    <div class=\"attribute_snippet\" v-for=\"tag in lead_tags\">{{tag.name}}</div>\r\n                    <select class=\"attribute_snippet\" style=\"border:none;\" name=\"lead_tags\" v-model=\"campaign.lead_tags\">\r\n                      <option v-for=\"tag in lead_tags\" :value=\"tag.id\">{{ tag.name }}</option>\r\n                    </select>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              \r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"card p-0\"> \r\n            <div class=\"card-header flex-align\">\r\n              <h4>Availbale Emails</h4>\r\n              <!--<button class=\"btn btn-primary py-1\">Edit</button>-->\r\n            </div>\r\n            <div class=\"card-body\">\r\n              <div class=\"\">\r\n                <h4 class=\"text-primary text-14\">{{campaign.leads.length}}  Emails</h4>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <!--<div class=\"card p-0\"> \r\n            <div class=\"card-header flex-align\">\r\n              <h4>Template</h4>\r\n              <router-link :to=\"'/select-template/'+campaign.id\">\r\n                <button type=\"button\" class=\"btn btn-primary py-1\">{{campaign.template?'Change':'Add'}}</button>\r\n              </router-link>\r\n              <div v-show=\"false\">\r\n                <input type=\"text\" name=\"template\" v-model=\"campaign.template\"/>\r\n              </div>\r\n            </div>\r\n            <div class=\"card-body temp-box text-center\" v-if=\"campaign.template\">\r\n              <img :src=\"api_url+campaign.template_logo\" class=\"p-1\">\r\n            </div>\r\n          </div>-->\r\n        </main>\r\n        <div class=\"footer-next\">\r\n          <button type=\"button\" class=\"btn btn-lg btn-primary px-3\" :disabled=\"!campaign.template\" @click=\"dataForm();crnt_tab='view'\">Save & Next</button>\r\n        </div>\r\n      </div>\r\n      <div class=\"email-sections\" v-show=\"crnt_tab=='view'\">\r\n        <main class=\"lead-main\" >\r\n          <!--<div class=\"card p-0\"> \r\n            <div class=\"card-header flex-align\">\r\n              <h4>Designed Email</h4>\r\n            </div>\r\n            <div class=\"card-body text-center\">\r\n              <router-link :to=\"'/edit-template/'+campaign.id+'/'+campaign.template\" v-if=\"campaign.id\">\r\n                <img :src=\"api_url+campaign.template_logo\" class=\"\">\r\n              </router-link>\r\n            </div>\r\n          </div>-->\r\n          <!--<div class=\"card2 w-100 mt-\"> \r\n            <div class=\"card-header2 w-100 flex-align\">\r\n              <h4>Subject</h4>\r\n            </div>\r\n            <div class=\"pt-3 pb-2\">\r\n              <p class=\"m-0\" v-html=\"campaign.subject\"></p>\r\n            </div>\r\n            <div>\r\n              <h5 class=\"mb-2 card p-3\">CRM Contents: <span v-for=\"lead_category in lead_categories\" v-if=\"campaign.lead_categories.includes(lead_category.id)\">{{lead_category.name}}</span></h5>\r\n            </div>\r\n          </div>-->\r\n          <div class=\"card p-0\"> \r\n            <div class=\"card-header w-100 flex-align\">\r\n              <h4>Confirmation</h4>\r\n            </div>\r\n            \r\n            <div class=\"card-body\">\r\n              <div class=\"row\">\r\n                <div class=\"col-12 mb-3\">\r\n                  <h4 class=\"mb-2\">From:</h4>\r\n                  <div class=\"attribute_snippet\" style=\"width: fit-content;\">{{$root.userInfo.aws_email}}</div>\r\n                </div>\r\n                <div class=\"col-12 mb-3\">\r\n                  <h4 class=\"mb-2\">Email Subject:</h4>\r\n                  <div class=\"attribute_snippet\" style=\"white-space: pre-wrap;\">{{campaign.subject}}</div>\r\n                </div>\r\n                <div class=\"col-12\">\r\n                  <h4 class=\"mb-2\">Audeince:</h4>\r\n                  <div class=\"d-flex g2\">\r\n                    <div class=\"attribute_snippet\" style=\"width: fit-content;\" v-for=\"lead_category in lead_categories\" v-if=\"lead_category.id==campaign.lead_category\">{{lead_category.name}}</div>\r\n                    <div class=\"attribute_snippet\" style=\"width: fit-content;\">{{campaign.lead_status}}</div>\r\n                    <div class=\"attribute_snippet\" style=\"width: fit-content;\">{{campaign.leads.length}}  Emails</div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </main>\r\n        <div class=\"footer-next\">\r\n          <button type=\"button\" class=\"btn btn-lg btn-light  px-3\" :disabled=\"!(campaign.status=='Draft' || campaign.status=='Temp' || campaign.status=='Failed')\" @click=\"crnt_tab='edit'\">Edit</button>\r\n          <button type=\"submit\" v-if=\"campaign.status=='Draft' || campaign.status=='Temp'\" @click=\"campaign.status='Starting'\" class=\"btn btn-lg btn-primary  px-3\">Send</button>\r\n          <button type=\"submit\" v-else-if=\"campaign.status=='Sending'\" @click=\"stopCampaign()\" class=\"btn btn-lg btn-primary  px-3\">Stop</button>\r\n          <button type=\"submit\" v-else @click=\"viewAnalytics()\" class=\"btn btn-lg btn-primary  px-3\">Analytics</button>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  </div>\r\n</template>\r\n<script>\r\nimport MainHeader from '/src/views/app/pages/header'\r\n\r\nexport default {\r\n    metaInfo: {\r\n        title: \"Home\"\r\n    },\r\n    components:{\r\n      MainHeader,\r\n    },\r\n    data() {\r\n      return {\r\n        campaign:{id:null, status:'Draft', template:null, template_logo:'', start_date:null, end_date:null, leads:[], lead_categories:[], lead_tags:[], lead_category:null, lead_status:''},\r\n        templates:[],\r\n        lead_categories:[],\r\n        lead_tags:[],\r\n        leads:[],\r\n        show_edit_template: false,\r\n        crnt_tab: \"edit\",\r\n      };\r\n    },\r\n    mounted() {\r\n      if(this.$route.params.id){\r\n        this.campaign.id = this.$route.params.id\r\n        this.getCampaign()\r\n      }\r\n      this.getTemplates()\r\n      this.getCategories()\r\n      this.getTags()\r\n      if(this.$root.auth_token){\r\n        this.getUser()\r\n      }\r\n    },\r\n    methods: {\r\n      getCampaign() {\r\n        var headers = new Headers();\r\n        headers.append(\"Authorization\", \"Bearer \"+this.$root.auth_token);\r\n        fetch(this.api_url+'/employee/campaigns/'+this.campaign.id+'/', {\r\n            method : 'get',\r\n            headers: headers,\r\n        })\r\n        .then((response) => {\r\n            return response.json()\r\n        })\r\n        .then((jsonData) => {\r\n          this.campaign = jsonData\r\n          if(jsonData.name && jsonData.subject){\r\n            this.crnt_tab = 'view'\r\n          }\r\n        })\r\n      },\r\n      dataForm(method='POST'){\r\n        if(this.$root.lock_btn){\r\n          return false\r\n        }\r\n        this.$root.lock_btn = true\r\n        var formdata = new FormData(this.$refs['dataForm'])\r\n        formdata.append('status', this.campaign.status)\r\n        formdata.append('user', this.$root.userId)\r\n        var headers = new Headers();\r\n        headers.append(\"Authorization\", \"Bearer \"+this.$root.auth_token);\r\n        var params = ''\r\n        if(this.campaign.id){\r\n          method = 'PUT'\r\n          params+=this.campaign.id+'/'\r\n        }\r\n        fetch(this.api_url+'/employee/campaigns/'+params, {\r\n            method : method,\r\n            body : formdata,\r\n            headers: headers,\r\n        })\r\n        .then((response) => {\r\n            return response.json()\r\n        })\r\n        .then((jsonData) => {\r\n          this.$root.lock_btn = false\r\n          if(jsonData.id>0){\r\n            this.campaign = jsonData\r\n            if(this.campaign.status=='Starting'){\r\n              this.startCampaign()\r\n            }\r\n          }else{\r\n            this.showAlert('Something Wrong!')\r\n          }\r\n        })\r\n      },\r\n      getTemplates() {\r\n        var headers = new Headers();\r\n        headers.append(\"Authorization\", \"Bearer \"+this.$root.auth_token);\r\n        fetch(this.api_url+'/employee/templates/', {\r\n            method : 'get',\r\n            headers: headers,\r\n        })\r\n        .then((response) => {\r\n            return response.json()\r\n        })\r\n        .then((jsonData) => {\r\n          this.templates = jsonData\r\n        })\r\n      },\r\n      getCategories() {\r\n        var headers = new Headers();\r\n        headers.append(\"Authorization\", \"Bearer \"+this.$root.auth_token);\r\n        fetch(this.api_url+'/employee/lead_categories/?user_wise=yes', {\r\n            method : 'get',\r\n            headers: headers,\r\n        })\r\n        .then((response) => {\r\n            return response.json()\r\n        })\r\n        .then((jsonData) => {\r\n          this.lead_categories = jsonData\r\n          if(jsonData.length>0){\r\n            this.campaign.lead_category = jsonData[0].id\r\n          }\r\n        })\r\n      },\r\n      getTags() {\r\n        var headers = new Headers();\r\n        headers.append(\"Authorization\", \"Bearer \"+this.$root.auth_token);\r\n        fetch(this.api_url+'/employee/lead_tags/?user_wise=yes', {\r\n            method : 'get',\r\n            headers: headers,\r\n        })\r\n        .then((response) => {\r\n            return response.json()\r\n        })\r\n        .then((jsonData) => {\r\n          this.lead_tags = jsonData\r\n        })\r\n      },\r\n      showLeads() {\r\n        var headers = new Headers();\r\n        var formdata = new FormData(this.$refs['dataForm'])\r\n        headers.append(\"Authorization\", \"Bearer \"+this.$root.auth_token);\r\n        fetch(this.api_url+'/employee/get_filter_leads/', {\r\n            method : 'POST',\r\n            body : formdata,\r\n            headers: headers,\r\n        })\r\n        .then((response) => {\r\n            return response.json()\r\n        })\r\n        .then((jsonData) => {\r\n          if(jsonData.success){\r\n            this.leads = jsonData.leads\r\n            this.campaign.leads = jsonData.leads\r\n          }\r\n        })\r\n      },\r\n      startCampaign() {\r\n        var headers = new Headers();\r\n        var formdata = new FormData()\r\n        formdata.append('campaign', this.campaign.id)\r\n        headers.append(\"Authorization\", \"Bearer \"+this.$root.auth_token);\r\n        fetch(this.api_url+'/employee/get_filter_leads/', {\r\n            method : 'PUT',\r\n            body : formdata,\r\n            headers: headers,\r\n        })\r\n        .then((response) => {\r\n            return response.json()\r\n        })\r\n        .then((jsonData) => {\r\n          if(jsonData.success){\r\n            // this.campaign = jsonData\r\n          }\r\n        })\r\n      },\r\n      selectTemplate(template){\r\n        this.campaign.template=template.id;\r\n        this.campaign.template_logo=template.logo.replace(this.api_url,'');\r\n        this.show_edit_template=false;\r\n      },\r\n      backPage(){\r\n        if(this.crnt_tab=='view' || this.crnt_tab=='edit'){\r\n          this.$router.push('/campaigns')\r\n        }\r\n      },\r\n    },\r\n};\r\n</script>\r\n<style scoped>\r\n\r\n@import './style/style.css';\r\n  \r\n\r\n  .footer-next{\r\n  height:70px;\r\n  display:flex;\r\n\r\n\r\n  }\r\n</style>\r\n"]}]}